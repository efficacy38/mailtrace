---
method: ssh
log_level: INFO
timeout: 30
auto_continue: false

# MX auto-discovery settings (optional)
# Enables automatic discovery of mail servers via DNS MX lookups
# mx_discovery:
#   servers: []        # Custom DNS servers (empty = system resolver)
#   timeout: 5         # DNS query timeout in seconds
#   cache_ttl: 0       # Cache TTL in seconds (0 = no cache)

# Passwords can also be loaded from environment variables or a .env file
# placed alongside this config file. See .env.example for supported variables.
#
# SECURITY RECOMMENDATIONS:
# - Use SSH keys instead of passwords when possible
# - Use environment variables or interactive prompts for passwords
# - Enable SSL certificate verification in production (verify_certs: true)
# - Keep known_hosts_file configured for SSH host key verification
ssh_config:
  username: username
  password: ""
  private_key: /home/username/.ssh/id_rsa
  sudo_pass: ""
  sudo: true
  timeout: 10
  ssh_config_file: demo/docker/ssh_config
  # SECURITY: Path to known_hosts file for SSH host key verification.
  # Set to empty string to disable verification (NOT RECOMMENDED for production).
  known_hosts_file: ~/.ssh/known_hosts
  host_config:
    log_files:
      - /var/log/mail.log
      - /data/log/mail.log
      - /data/log/maillog
    # log_parser: SyslogParser  # Optional - auto-detects RFC 3164 vs RFC 5424 format
    # Available parsers: SyslogParser (auto), Rfc5424Parser, Rfc3164Parser
    time_format: "%Y-%m-%dT%H:%M:%S"
  hosts:
    mx1.mydomain.com:
      # log_parser: Rfc3164Parser  # Force BSD syslog format
      # time_format: "%b %d %H:%M:%S"
    # mx2.mydomain.com will use default host_config (auto-detect)
    backup-mail.mydomain.com:
      # log_parser: Rfc5424Parser  # Force ISO 8601 format
      # time_format: "%Y-%m-%d %H:%M:%S"
opensearch_config:
  host: "localhost" # OpenSearch host address
  port: 9200 # OpenSearch port number
  username: "admin" # Username for OpenSearch authentication
  # Password for OpenSearch authentication. Can also be loaded from MAILTRACE_OPENSEARCH_PASSWORD environment variable.
  password: ""
  index: "mailtrace-logs-*" # OpenSearch index name or pattern for log storage
  use_ssl: true # Whether to use SSL/TLS encryption
  # SECURITY: verify_certs should be true in production to prevent MITM attacks.
  # Only set to false for local development with self-signed certificates.
  verify_certs: true # Whether to verify SSL certificates
  time_zone: "+00:00" # Timezone offset for log timestamps
  timeout: 10 # Connection timeout in seconds
  mapping: # Mapping of application field names to OpenSearch field names
    facility: "log.syslog.facility.name"
    hostname: "host.name"
    message: "message"
    timestamp: "@timestamp"
    service: "log.syslog.appname"
    queueid: "postfix.queueid.keyword"
    queued_as: "postfix.queued_as.keyword"
    message_id: "postfix.message-id.keyword"  # RFC 2822 Message-ID for cross-host batch tracing
# Clusters define groups of mail servers to trace logs from
# Use "mx:" prefix for auto-discovery via DNS MX lookups
clusters:
  mx-cluster:
    - mx-cluster.mydomain.com
    - mx-cluster.mydomain.com
  # Example with MX auto-discovery:
  # auto-discovered:
  #   - "mx:example.com"           # Resolve mail servers via MX lookup
  #   - static-backup.example.com  # Static entry (no lookup)
